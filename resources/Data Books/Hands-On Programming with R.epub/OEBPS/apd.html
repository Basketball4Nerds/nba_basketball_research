<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" xmlns:m="http://www.w3.org/1998/Math/MathML" xmlns:pls="http://www.w3.org/2005/01/pronunciation-lexicon" xmlns:ssml="http://www.w3.org/2001/10/synthesis" xmlns:svg="http://www.w3.org/2000/svg"><head><title>Appendix D. Loading and Saving Data in R</title><link rel="stylesheet" type="text/css" href="core.css"/><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"/><link rel="up" href="pt03.html" title="Part III. Project 3: Slot Machine"/><link rel="prev" href="apc.html" title="Appendix C. Updating R and Its Packages"/><link rel="next" href="ape.html" title="Appendix E. Debugging R Code"/></head><body><section class="appendix" title="Appendix D. Loading and Saving Data in R" epub:type="appendix" id="DATAIO"><div class="titlepage"><div><div><h2 class="title">Appendix D. Loading and Saving Data in R</h2></div></div></div><p>This appendix will show you how to load and save data into R from plain-text files, R files, and Excel spreadsheets. It will also show you the R packages that you can use to load data from databases and other common programs, like SAS and MATLAB.</p><div class="sect1" title="Data Sets in Base R"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="_data_sets_in_base_r">Data Sets in Base R</h2></div></div></div><p>R comes with many data sets preloaded in the <code class="literal">datasets</code> package, which comes with base R. These data sets are not very interesting, but they give you a chance to test code or make a point without having to load a data set from outside R.<a id="id542262" class="indexterm"/><a id="id542289" class="indexterm"/><a id="id542271" class="indexterm"/> You can see a list of R’s data sets as well as a short description of each by running:</p><pre class="programlisting">help<code class="p">(</code>package <code class="o">=</code> <code class="s">"datasets"</code><code class="p">)</code></pre><p>To use a data set, just type its name.<a id="id542323" class="indexterm"/> Each data set is already presaved as an R object. For example:</p><pre class="programlisting">iris
<code class="c1">##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</code>
<code class="c1">## 1          5.1         3.5          1.4         0.2  setosa</code>
<code class="c1">## 2          4.9         3.0          1.4         0.2  setosa</code>
<code class="c1">## 3          4.7         3.2          1.3         0.2  setosa</code>
<code class="c1">## 4          4.6         3.1          1.5         0.2  setosa</code>
<code class="c1">## 5          5.0         3.6          1.4         0.2  setosa</code>
<code class="c1">## 6          5.4         3.9          1.7         0.4  setosa</code></pre><p>However, R’s data sets are no substitute for your own data, which you can load into R from a wide variety of file formats. But before you load any data files into R, you’ll need to determine where your <span class="emphasis"><em>working directory</em></span> is.</p></div><div class="sect1" title="Working Directory"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="_working_directory">Working Directory</h2></div></div></div><p>Each time you open R, it links itself to a directory on your computer, which R calls the working directory. This is where R will look for files when you attempt to load them, and it is where R will save files when you save them. The location of your working directory will vary on different computers.<a id="id542391" class="indexterm"/><a id="id542419" class="indexterm"/><a id="id542427" class="indexterm"/> To determine which directory R is using as your working directory, run:</p><pre class="programlisting">getwd<code class="p">()</code>
<code class="c1">## "/Users/garrettgrolemund"</code></pre><p>You can place data files straight into the folder that is your working directory, or you can move your working directory to where your data files are. You can move your working directory to any folder on your computer with the function <code class="literal">setwd</code>. Just give <code class="literal">setwd</code> the file path to your new working directory. I prefer to set my working directory to a folder dedicated to whichever project I am currently working on.<a id="id542490" class="indexterm"/><a id="id542473" class="indexterm"/> That way I can keep all of my data, scripts, graphs, and reports in the same place. For example:</p><pre class="programlisting">setwd<code class="p">(</code><code class="s">"~/Users/garrettgrolemund/Documents/Book_Project"</code><code class="p">)</code></pre><p>If the file path does not begin with your root directory, R will assume that it begins at your current working directory.</p><p>You can also change your working directory by clicking on Session &gt; Set Working Directory &gt; Choose Directory in the RStudio menu bar. The Windows and Mac GUIs have similar options. If you start R from a UNIX command line (as on Linux machines), the working directory will be whichever directory you were in when you called R.<a id="id542509" class="indexterm"/><a id="id542520" class="indexterm"/></p><p>You can see what files are in your working directory with <code class="literal">list.files()</code>.  If you see the file that you would like to open in your working directory, then you are ready to proceed. How you open files in your working directory will depend on which type of file you would like to open.<a id="id542543" class="indexterm"/><a id="id542565" class="indexterm"/><a id="id542573" class="indexterm"/></p></div><div class="sect1" title="Plain-text Files"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="_plain_text_files">Plain-text Files</h2></div></div></div><p>Plain-text files are one of the most common ways to save data. They are very simple and can be read by many different computer programs—even the most basic text editors. For this reason, public data often comes as plain-text files. For example, the Census Bureau, the Social Security Administration, and the Bureau of Labor Statistics all make their data available as plain-text files.<a id="ix_DLSplain" class="indexterm"/><a id="id542590" class="indexterm"/><a id="id542600" class="indexterm"/></p><p>Here’s how the royal flush data set from <a class="xref" href="ch03.html" title="Chapter 3. R Objects">Chapter 3</a> would appear as a plain-text file (I’ve added a value column):</p><pre class="screen">"card", "suit", "value"
"ace", "spades", 14
"king", "spades", 13
"queen", "spades", 12
"jack", "spades", 11
"ten", "spades", 10</pre><p>A plain-text file stores a table of data in a text document. Each row of the table is saved on its own line, and a simple convention is used to separate the cells within a row. Often cells are separated by a comma, but they can also be separated by a tab, a pipe delimiter (i.e., <code class="literal">|</code> ), or any other character. Each file only uses one method of separating cells, which minimizes confusion. Within each cell, data appears as you’d expect to see it, as words and numbers.<a id="id542654" class="indexterm"/></p><p>All plain-text files can be saved with the extension <span class="emphasis"><em>.txt</em></span> (for text), but sometimes a file will receive a special extension that advertises how it separates data-cell entries. Since entries in the data set mentioned earlier are separated with a comma, this file would be a <span class="emphasis"><em>comma-separated-values</em></span> file and would usually be saved with the extension <span class="emphasis"><em>.csv</em></span>. <a id="id542662" class="indexterm"/></p><div class="sect2" title="read.table"><div class="titlepage"><div><div><h3 class="title" id="_read_table">read.table</h3></div></div></div><p>To load a plain-text file, use <code class="literal">read.table</code>.<a id="id542703" class="indexterm"/><a id="id542711" class="indexterm"/> The first argument of <code class="literal">read.table</code> should be the name of your file (if it is in your working directory), or the file path to your file (if it is not in your working directory). If the file path does not begin with your root directory, R will append it to the end of the file path that leads to your working directory.You can give <code class="literal">read.table</code> other arguments as well. The two most important are <code class="literal">sep</code> and <code class="literal">header</code>.</p><p>If the royal flush data set was saved as a file named <span class="emphasis"><em>poker.csv</em></span> in your working directory, you could load it with:</p><pre class="programlisting">poker <code class="o">&lt;-</code> read.table<code class="p">(</code><code class="s">"poker.csv"</code><code class="p">,</code> sep <code class="o">=</code> <code class="s">","</code><code class="p">,</code> header <code class="o">=</code> <code class="kc">TRUE</code><code class="p">)</code></pre><div class="sect3" title="sep"><div class="titlepage"><div><div><h4 class="title" id="_sep">sep</h4></div></div></div><p>Use <code class="literal">sep</code> to tell <code class="literal">read.table</code> what character your file uses to separate data entries. To find this out, you might have to open your file in a text editor and look at it. If you don’t specify a <code class="literal">sep</code> argument, <code class="literal">read.table</code> will try to separate cells whenever it comes to white space, such as a tab or space. R won’t be able to tell you if <code class="literal">read.table</code> does this correctly or not, so rely on it at your own risk.<a id="id542837" class="indexterm"/><a id="id542847" class="indexterm"/></p></div><div class="sect3" title="header"><div class="titlepage"><div><div><h4 class="title" id="_header">header</h4></div></div></div><p>Use <code class="literal">header</code> to tell <code class="literal">read.table</code> whether the first line of the file contains variable names instead of values. If the first line of the file is a set of variable names, you should set <code class="literal">header = TRUE</code>.<a id="id542879" class="indexterm"/><a id="id542889" class="indexterm"/></p></div><div class="sect3" title="na.strings"><div class="titlepage"><div><div><h4 class="title" id="_na_strings">na.strings</h4></div></div></div><p>Oftentimes data sets will use special symbols to represent missing information.<a id="id542911" class="indexterm"/><a id="id542922" class="indexterm"/><a id="id542929" class="indexterm"/><a id="id542937" class="indexterm"/> If you know that your data uses a certain symbol to represent missing entries, you can tell <code class="literal">read.table</code> (and the preceding functions) what the symbol is with the <code class="literal">na.strings</code> argument. <code class="literal">read.table</code> will convert all instances of the missing information symbol to <code class="literal">NA</code>, which is R’s missing information symbol (see <a class="xref" href="ch05.html#MISSING" title="Missing Information">Missing Information</a>).</p><p>For example, your poker data set contained missing values stored as a <code class="literal">.</code>, like this:</p><pre class="programlisting"><code class="c1">## "card","suit","value"</code>
<code class="c1">## "ace"," spades"," 14"</code>
<code class="c1">## "king"," spades"," 13"</code>
<code class="c1">## "queen",".","."</code>
<code class="c1">## "jack",".","."</code>
<code class="c1">## "ten",".","."</code></pre><p>You could read the data set into R and convert the missing values into NAs as you go with the command:</p><pre class="programlisting">poker <code class="o">&lt;-</code> read.table<code class="p">(</code><code class="s">"poker.csv"</code><code class="p">,</code> sep <code class="o">=</code> <code class="s">","</code><code class="p">,</code> header <code class="o">=</code> <code class="kc">TRUE</code><code class="p">,</code> na.string <code class="o">=</code> <code class="s">"."</code><code class="p">)</code></pre><p>R would save a version of <code class="literal">poker</code> that looks like this:</p><pre class="programlisting"><code class="c1">##  card    suit value</code>
<code class="c1">##   ace  spades    14</code>
<code class="c1">##  king  spades    13</code>
<code class="c1">## queen    &lt;NA&gt;    NA</code>
<code class="c1">##  jack    &lt;NA&gt;    NA</code>
<code class="c1">##   ten    &lt;NA&gt;    NA</code></pre></div><div class="sect3" title="skip and nrow"><div class="titlepage"><div><div><h4 class="title" id="_skip_and_nrow">skip and nrow</h4></div></div></div><p>Sometimes a plain-text file will come with introductory text that is not part of the data set. Or, you may decide that you only wish to read in part of a data set. You can do these things with the <code class="literal">skip</code> and <code class="literal">nrow</code> arguments. Use <code class="literal">skip</code> to tell R to skip a specific number of lines before it starts reading in values from the file. Use <code class="literal">nrow</code> to tell R to stop reading in values after it has read in a certain number of lines.<a id="id543177" class="indexterm"/><a id="id543167" class="indexterm"/><a id="id543190" class="indexterm"/><a id="id543198" class="indexterm"/></p><p>For example, imagine that the complete royal flush file looks like this:</p><pre class="programlisting">This data was collected by the National Poker Institute.
We accidentally repeated the last row of data.

<code class="s">"card"</code><code class="p">,</code> <code class="s">"suit"</code><code class="p">,</code> <code class="s">"value"</code>
<code class="s">"ace"</code><code class="p">,</code> <code class="s">"spades"</code><code class="p">,</code> <code class="m">14</code>
<code class="s">"king"</code><code class="p">,</code> <code class="s">"spades"</code><code class="p">,</code> <code class="m">13</code>
<code class="s">"queen"</code><code class="p">,</code> <code class="s">"spades"</code><code class="p">,</code> <code class="m">12</code>
<code class="s">"jack"</code><code class="p">,</code> <code class="s">"spades"</code><code class="p">,</code> <code class="m">11</code>
<code class="s">"ten"</code><code class="p">,</code> <code class="s">"spades"</code><code class="p">,</code> <code class="m">10</code>
<code class="s">"ten"</code><code class="p">,</code> <code class="s">"spades"</code><code class="p">,</code> <code class="m">10</code></pre><p>You can read just the six lines (five rows plus a header) that you want with:</p><pre class="programlisting">read.table<code class="p">(</code><code class="s">"poker.csv"</code><code class="p">,</code> sep <code class="o">=</code> <code class="s">","</code><code class="p">,</code> header <code class="o">=</code> <code class="kc">TRUE</code><code class="p">,</code> skip <code class="o">=</code> <code class="m">3</code><code class="p">,</code> nrow <code class="o">=</code> <code class="m">5</code><code class="p">)</code>
<code class="c1">##    card    suit value</code>
<code class="c1">## 1   ace  spades    14</code>
<code class="c1">## 2  king  spades    13</code>
<code class="c1">## 3 queen  spades    12</code>
<code class="c1">## 4  jack  spades    11</code>
<code class="c1">## 5   ten  spades    10</code></pre><p>Notice that the header row doesn’t count towards the total rows allowed by <code class="literal">nrow</code>.</p></div><div class="sect3" title="stringsAsFactors"><div class="titlepage"><div><div><h4 class="title" id="_stringsasfactors">stringsAsFactors</h4></div></div></div><p>R reads in numbers just as you’d expect, but when R comes across character strings (e.g., letters and words) it begins to act strangely.<a id="id543567" class="indexterm"/><a id="id543560" class="indexterm"/><a id="id543565" class="indexterm"/><a id="id543580" class="indexterm"/> R wants to convert every character string into a factor. This is R’s default behavior, but I think it is a mistake. Sometimes factors are useful. At other times, they’re clearly the wrong data type for the job. Also factors cause weird behavior, especially when you want to display data. This behavior can be surprising if you didn’t realize that R converted your data to factors. In general, you’ll have a smoother R experience if you don’t let R make factors until you ask for them. Thankfully, it is easy to do this.</p><p>Setting the argument <code class="literal">stringsAsFactors</code> to <code class="literal">FALSE</code> will ensure that R saves any character strings in your data set as character strings, not factors. To use <code class="literal">stringsAsFactors</code>, you’d write:</p><pre class="programlisting">read.table<code class="p">(</code><code class="s">"poker.csv"</code><code class="p">,</code> sep <code class="o">=</code> <code class="s">","</code><code class="p">,</code> header <code class="o">=</code> <code class="kc">TRUE</code><code class="p">,</code> stringsAsFactors <code class="o">=</code> <code class="kc">FALSE</code><code class="p">)</code></pre><p>If you will be loading more than one data file, you can change the default factoring behavior at the global level with:</p><pre class="programlisting">options<code class="p">(</code>stringsAsFactors <code class="o">=</code> <code class="kc">FALSE</code><code class="p">)</code></pre><p>This will ensure that all strings will be read as strings, not as factors, until you end your R session, or rechange the global default by running:</p><pre class="programlisting">options<code class="p">(</code>stringsAsFactors <code class="o">=</code> <code class="kc">TRUE</code><code class="p">)</code></pre></div></div><div class="sect2" title="The read Family"><div class="titlepage"><div><div><h3 class="title" id="_the_read_family">The read Family</h3></div></div></div><p>R also comes with some prepackaged short cuts for <code class="literal">read.table</code>, shown in <a class="xref" href="apd.html#TABLE-READ-SHORTCUTS" title="Table D-1. R’s read functions. You can overwrite any of the default arguments as necessary.">Table D-1</a>.<a id="id543759" class="indexterm"/><a id="id543770" class="indexterm"/><a id="id543779" class="indexterm"/><a id="id543785" class="indexterm"/><a id="id543791" class="indexterm"/><a id="id543798" class="indexterm"/></p><div class="table"><a id="TABLE-READ-SHORTCUTS"/><div class="table-title">Table D-1. R’s read functions. You can overwrite any of the default arguments as necessary.</div><div class="table-contents"><table style="width: 90%; border-collapse: collapse; border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/></colgroup><thead><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">Function</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">Defaults</td><td style="border-bottom: 0.5pt solid ; ">Use</td></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">read.table</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>sep = " “, header = FALSE</p></td><td style="border-bottom: 0.5pt solid ; "><p>General-purpose read function</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">read.csv</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>sep = “,”, header = TRUE</p></td><td style="border-bottom: 0.5pt solid ; "><p>Comma-separated-variable (CSV) files</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">read.delim</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>sep = “\t”, header = TRUE</p></td><td style="border-bottom: 0.5pt solid ; "><p>Tab-delimited files</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">read.csv2</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>sep = “;”, header = TRUE, dec = “,”</p></td><td style="border-bottom: 0.5pt solid ; "><p>CSV files with European decimal format</p></td></tr><tr><td style="border-right: 0.5pt solid ; "><p><code class="literal">read.delim2</code></p></td><td style="border-right: 0.5pt solid ; "><p>sep = “\t”, header = TRUE, dec = “,”</p></td><td><p>Tab-delimited files with European decimal format</p></td></tr></tbody></table></div></div><p>The first shortcut, <code class="literal">read.csv</code>, behaves just like <code class="literal">read.table</code> but automatically sets <code class="literal">sep = ","</code> and <code class="literal">header = TRUE</code>, which can save you some typing:</p><pre class="programlisting">poker <code class="o">&lt;-</code> read.csv<code class="p">(</code><code class="s">"poker.csv"</code><code class="p">)</code></pre><p><code class="literal">read.delim</code> automatically sets <code class="literal">sep</code> to the tab character, which is very handy for reading tab delimited files. These are files where each cell is separated by a tab. <code class="literal">read.delim</code> also sets <code class="literal">header = TRUE</code> by default.</p><p><code class="literal">read.delim2</code> and <code class="literal">read.csv2</code> exist for European R users. These functions tell R that the data uses a comma instead of a period to denote decimal places. (If you’re wondering how this works with CSV files, CSV2 files usually separate cells with a semicolon, not a comma.)</p><div class="tip" title="Import Dataset"><h3 class="title">Import Dataset</h3><p>You can also load plain text files with RStudio’s Import Dataset button, as described in <a class="xref" href="ch03.html#LOADING" title="Loading Data">Loading Data</a>. Import Dataset provides a GUI version of <code class="literal">read.table</code>.</p></div></div><div class="sect2" title="read.fwf"><div class="titlepage"><div><div><h3 class="title" id="_read_fwf">read.fwf</h3></div></div></div><p>One type of plain-text file defies the pattern by using its layout to separate data cells. Each row is placed in its own line (as with other plain-text files), and then each column begins at a specific number of characters from the lefthand side of the document. To achieve this, an arbitrary number of character spaces is added to the end of each entry to correctly position the next entry. These documents are known as <span class="emphasis"><em>fixed-width files</em></span> and usually end with the extension <span class="emphasis"><em>.fwf</em></span>.<a id="id544094" class="indexterm"/><a id="id544104" class="indexterm"/><a id="id544110" class="indexterm"/><a id="id544116" class="indexterm"/></p><p>Here’s one way the royal flush data set could look as a fixed-width file. In each row, the suit entry begins exactly 10 characters from the start of the line. It doesn’t matter how many characters appeared in the first cell of each row:</p><pre class="screen">card      suit       value
ace       spades     14
king      spades     13
queen     spades     12
jack      spades     11
10        spades     10</pre><p>Fixed-width files look nice to human eyes (but no better than a tab-delimited file); however, they can be difficult to work with. Perhaps because of this, R comes with a function for reading fixed-width files, but no function for saving them. Unfortunately, US government agencies seem to like fixed-width files, and you’ll likely encounter one or more during your career.</p><p>You can read fixed-width files into R with the function <code class="literal">read.fwf</code>. The function takes the same arguments as <code class="literal">read.table</code> but requires an additional argument, <code class="literal">widths</code>, which should be a vector of numbers. Each <span class="emphasis"><em>i</em></span>th entry of the <code class="literal">widths</code> vector should state the width (in characters) of the <span class="emphasis"><em>i</em></span>th column of the data set.</p><p>If the aforementioned fixed-width royal flush data was saved as <span class="emphasis"><em>poker.fwf</em></span> in your working directory, you could read it with:</p><pre class="programlisting">poker <code class="o">&lt;-</code> read.fwf<code class="p">(</code><code class="s">"poker.fwf"</code><code class="p">,</code> widths <code class="o">=</code> c<code class="p">(</code><code class="m">10</code><code class="p">,</code> <code class="m">7</code><code class="p">,</code> <code class="m">6</code><code class="p">),</code> header <code class="o">=</code> <code class="kc">TRUE</code><code class="p">)</code></pre></div><div class="sect2" title="HTML Links"><div class="titlepage"><div><div><h3 class="title" id="_html_links">HTML Links</h3></div></div></div><p>Many data files are made available on the Internet at their own web address.<a id="id544279" class="indexterm"/><a id="id544292" class="indexterm"/><a id="id544298" class="indexterm"/> If you are connected to the Internet, you can open these files straight into R with <code class="literal">read.table</code>, <code class="literal">read.csv</code>, etc. You can pass a web address into the file name argument for any of R’s data-reading functions. As a result, you could read in the poker data set from a web address like <span class="emphasis"><em>http://…/poker.csv</em></span> with:</p><pre class="programlisting">poker <code class="o">&lt;-</code> read.csv<code class="p">(</code><code class="s">"http://.../poker.csv"</code><code class="p">)</code></pre><p>Just make sure that the web address links directly to the file and not to a web page that links to the file. Usually, when you visit a data file’s web address, the file will begin to download or the raw data will appear in your browser window.</p><p>Note that websites that begin with <span class="emphasis"><em>https://</em></span> are secure websites, which means R may not be able to access the data provided at these links.</p></div><div class="sect2" title="Saving Plain-Text Files"><div class="titlepage"><div><div><h3 class="title" id="_saving_plain_text_files">Saving Plain-Text Files</h3></div></div></div><p>Once your data is in R, you can save it to any file format that R supports. If you’d like to save it as a plain-text file, you can use the <code class="literal">write</code> family of functions. The three basic write functions appear in <a class="xref" href="apd.html#WRITE_TABLE" title="Table D-2. R saves data sets to plain-text files with the write family of functions">Table D-2</a>. Use <code class="literal">write.csv</code> to save your data as a <span class="emphasis"><em>.csv</em></span> file and <code class="literal">write.table</code> to save your data as a tab delimited document or a document with more exotic separators.<a id="id544413" class="indexterm"/><a id="id544404" class="indexterm"/><a id="id544410" class="indexterm"/><a id="id544419" class="indexterm"/></p><div class="table"><a id="WRITE_TABLE"/><div class="table-title">Table D-2. R saves data sets to plain-text files with the write family of functions</div><div class="table-contents"><table style="width: 100%; border-collapse: collapse; border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="col_1"/><col class="col_2"/></colgroup><thead><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">File format</td><td style="border-bottom: 0.5pt solid ; ">Function and syntax</td></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="emphasis"><em>.csv</em></span></p></td><td style="border-bottom: 0.5pt solid ; "><p><code class="literal">write.csv(r_object, file = filepath, row.names = FALSE)</code></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="emphasis"><em>.csv</em></span> (with European decimal notation)</p></td><td style="border-bottom: 0.5pt solid ; "><p><code class="literal">write.csv2(r_object, file = filepath, row.names = FALSE)</code></p></td></tr><tr><td style="border-right: 0.5pt solid ; "><p>tab delimited</p></td><td><p><code class="literal">write.table(r_object, file = filepath, sep = "\t", row.names=FALSE)</code></p></td></tr></tbody></table></div></div><p>The first argument of each function is the R object that contains your data set. The <code class="literal">file</code> argument is the file name (including extension) that you wish to give the saved data. By default, each function will save your data into your working directory. However, you can supply a file path to the file argument. R will oblige by saving the file at the end of the file path. If the file path does not begin with your root directory, R will append it to the end of the file path that leads to your working directory.</p><p>For example, you can save the (hypothetical) poker data frame to a subdirectory named <span class="emphasis"><em>data</em></span> within your working directory with the command:</p><pre class="programlisting">write.csv<code class="p">(</code>poker<code class="p">,</code> <code class="s">"data/poker.csv"</code><code class="p">,</code> row.names <code class="o">=</code> <code class="kc">FALSE</code><code class="p">)</code></pre><p>Keep in mind that <code class="literal">write.csv</code> and <code class="literal">write.table</code> cannot create new directories on your computer. Each folder in the file path must exist before you try to save a file with it.</p><p>The <code class="literal">row.names</code> argument prevents R from saving the data frame’s row names as a column in the plain-text file. You might have noticed that R automatically names each row in a data frame with a number. For example, each row in our poker data frame appears with a number next to it:</p><pre class="programlisting">poker
<code class="c1">##    card   suit value</code>
<code class="c1">## 1   ace spades    14</code>
<code class="c1">## 2  king spades    13</code>
<code class="c1">## 3 queen spades    12</code>
<code class="c1">## 4  jack spades    11</code>
<code class="c1">## 5    10 spades    10</code></pre><p>These row numbers are helpful, but can quickly accumulate if you start saving them. R will add a new set of numbers by default each time you read the file back in. Avoid this by always setting <code class="literal">row.names = FALSE</code> when you use a function in the <code class="literal">write</code> family.</p></div><div class="sect2" title="Compressing Files"><div class="titlepage"><div><div><h3 class="title" id="_compressing_files">Compressing Files</h3></div></div></div><p>To compress a plain-text file, surround the file name or file path with the function <code class="literal">bzfile</code>, <code class="literal">gzfile</code>, or <code class="literal">xzfile</code>.<a id="id544695" class="indexterm"/><a id="id544704" class="indexterm"/><a id="id544710" class="indexterm"/><a id="id544717" class="indexterm"/> For example:</p><pre class="programlisting">write.csv<code class="p">(</code>poker<code class="p">,</code> file <code class="o">=</code> bzfile<code class="p">(</code><code class="s">"data/poker.csv.bz2"</code><code class="p">),</code> row.names <code class="o">=</code> <code class="kc">FALSE</code><code class="p">)</code></pre><p>Each of these functions will compress the output with a different type of compression format, shown in <a class="xref" href="apd.html#COMPRESSION_TABLE" title="Table D-3. R comes with three helper functions for compressing files">Table D-3</a>.<a id="id544781" class="indexterm"/><a id="id544790" class="indexterm"/><a id="id544800" class="indexterm"/></p><div class="table"><a id="COMPRESSION_TABLE"/><div class="table-title">Table D-3. R comes with three helper functions for compressing files</div><div class="table-contents"><table style="width: 90%; border-collapse: collapse; border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="col_1"/><col class="col_2"/></colgroup><thead><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">Function</td><td style="border-bottom: 0.5pt solid ; ">Compression type</td></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">bzfile</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>bzip2</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">gzfile</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>gnu zip (gzip)</p></td></tr><tr><td style="border-right: 0.5pt solid ; "><p><code class="literal">xzfile</code></p></td><td><p>xz compression</p></td></tr></tbody></table></div></div><p>It is a good idea to adjust your file’s extension to reflect the compression. R’s <code class="literal">read</code> functions will open plain-text files compressed in any of these formats. For example, you could read a compressed file named <span class="emphasis"><em>poker.csv.bz2</em></span> with:</p><pre class="programlisting">read.csv<code class="p">(</code><code class="s">"poker.csv.bz2"</code><code class="p">)</code></pre><p>or:</p><pre class="programlisting">read.csv<code class="p">(</code><code class="s">"data/poker.csv.bz2"</code><code class="p">)</code></pre><p>depending on where the file is saved.<a id="id544965" class="indexterm"/></p></div></div><div class="sect1" title="R Files"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="_r_files">R Files</h2></div></div></div><p>R provides two file formats of its own for storing data, <span class="emphasis"><em>.RDS</em></span> and <span class="emphasis"><em>.RData</em></span>. RDS files can store a single R object, and RData files can store multiple R objects.<a id="id545008" class="indexterm"/><a id="id545010" class="indexterm"/><a id="id545019" class="indexterm"/><a id="id545028" class="indexterm"/><a id="id545036" class="indexterm"/><a id="id545048" class="indexterm"/><a id="id545058" class="indexterm"/></p><p>You can open a RDS file with <code class="literal">readRDS</code>. For example, if the royal flush data was saved as <span class="emphasis"><em>poker.RDS</em></span>, you could open it with:</p><pre class="programlisting">poker <code class="o">&lt;-</code> readRDS<code class="p">(</code><code class="s">"poker.RDS"</code><code class="p">)</code></pre><p>Opening RData files is even easier. Simply run the function <code class="literal">load</code> with the file:</p><pre class="programlisting">load<code class="p">(</code><code class="s">"file.RData"</code><code class="p">)</code></pre><p>There’s no need to assign the output to an object. The R objects in your RData file will be loaded into your R session with their original names. RData files can contain multiple R objects, so loading one may read in multiple objects. <code class="literal">load</code> doesn’t tell you how many objects it is reading in, nor what their names are, so it pays to know a little about the RData file before you load it.</p><p>If worse comes to worst, you can keep an eye on the environment pane in RStudio as you load an RData file. It displays all of the objects that you have created or loaded during your R session. Another useful trick is to put parentheses around your load command like so, <code class="literal">(load("poker.RData"))</code>. This will cause R to print out the names of each object it loads from the file.</p><p>Both <code class="literal">readRDS</code> and <code class="literal">load</code> take a file path as their first argument, just like R’s other read and write functions. If your file is in your working directory, the file path will be the file name.<a id="id545146" class="indexterm"/><a id="id545169" class="indexterm"/></p><div class="sect2" title="Saving R Files"><div class="titlepage"><div><div><h3 class="title" id="_saving_r_files">Saving R Files</h3></div></div></div><p>You can save an R object like a data frame as either an RData file or an RDS file. RData files can store multiple R objects at once, but RDS files are the better choice because they foster reproducible code.<a id="id545196" class="indexterm"/><a id="id545205" class="indexterm"/><a id="id545214" class="indexterm"/><a id="id545222" class="indexterm"/><a id="id545234" class="indexterm"/><a id="id545245" class="indexterm"/><a id="id545256" class="indexterm"/><a id="id545268" class="indexterm"/></p><p>To save data as an RData object, use the <code class="literal">save</code> function. To save data as a RDS object, use the <code class="literal">saveRDS</code> function. In each case, the first argument should be the name of the R object you wish to save. You should then include a file argument that has the file name or file path you want to save the data set to.<a id="id545281" class="indexterm"/><a id="id545287" class="indexterm"/></p><p>For example, if you have three R objects, <code class="literal">a</code>, <code class="literal">b</code>, and <code class="literal">c</code>, you could save them all in the same RData file and then reload them in another R session:</p><pre class="programlisting">a <code class="o">&lt;-</code> <code class="m">1</code>
b <code class="o">&lt;-</code> <code class="m">2</code>
c <code class="o">&lt;-</code> <code class="m">3</code>
save<code class="p">(</code>a<code class="p">,</code> b<code class="p">,</code> c<code class="p">,</code> file <code class="o">=</code> <code class="s">"stuff.RData"</code><code class="p">)</code>
load<code class="p">(</code><code class="s">"stuff.RData"</code><code class="p">)</code></pre><p>However, if you forget the names of your objects or give your file to someone else to use, it will be difficult to determine what was in the file—even after you (or they) load it. The user interface for RDS files is much more clear. You can save only one object per file, and whoever loads it can decide what they want to call their new data. As a bonus, you don’t have to worry about <code class="literal">load</code> overwriting any R objects that happened to have the same name as the objects you are loading:</p><pre class="programlisting">saveRDS<code class="p">(</code>a<code class="p">,</code> file <code class="o">=</code> <code class="s">"stuff.RDS"</code><code class="p">)</code>
a <code class="o">&lt;-</code> readRDS<code class="p">(</code><code class="s">"stuff.RDS"</code><code class="p">)</code></pre><p>Saving your data as an R file offers some advantages over saving your data as a plain-text file. R automatically compresses the file and will also save any R-related metadata associated with your object. This can be handy if your data contains factors, dates and times, or class attributes. You won’t have to reparse this information into R the way you would if you converted everything to a text file.<a id="id545530" class="indexterm"/><a id="id545541" class="indexterm"/><a id="id545489" class="indexterm"/></p><p>On the other hand, R files cannot be read by many other programs, which makes them inefficient for sharing. They may also create a problem for long-term storage if you don’t think you’ll have a copy of R when you reopen the files.</p></div></div><div class="sect1" title="Excel Spreadsheets"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="_excel_spreadsheets">Excel Spreadsheets</h2></div></div></div><p>Microsoft Excel is a popular spreadsheet program that has become almost industry standard in the business world. There is a good chance that you will need to work with an Excel spreadsheet in R at least once in your career. You can read spreadsheets into R and also save R data as a spreadsheet in a variety of ways.<a id="ix_DLSspread" class="indexterm"/><a id="id545518" class="indexterm"/></p><div class="sect2" title="Export from Excel"><div class="titlepage"><div><div><h3 class="title" id="_export_from_excel">Export from Excel</h3></div></div></div><p>The best method for moving data from Excel to R is to export the spreadsheet from Excel as a <span class="emphasis"><em>.csv</em></span> or <span class="emphasis"><em>.txt</em></span> file. Not only will R be able to read the text file, so will any other data analysis software. Text files are the lingua franca of data storage.<a id="id545576" class="indexterm"/><a id="id545585" class="indexterm"/></p><p>Exporting the data solves another difficulty as well. Excel uses proprietary formats and metadata that will not easily transfer into R. For example, a single Excel file can include multiple spreadsheets, each with their own columns and macros. When Excel exports the file as a <span class="emphasis"><em>.csv</em></span> or <span class="emphasis"><em>.txt</em></span>, it makes sure this format is transferred into a plain-text file in the most appropriate way. R may not be able to manage the conversion as efficiently.</p><p>To export data from Excel, open the Excel spreadsheet and then go to Save As in the Microsoft Office Button menu. Then choose CSV in the Save as type box that appears and save the files. You can then read the file into R with the <code class="literal">read.csv</code> function.<a id="id545655" class="indexterm"/></p></div><div class="sect2" title="Copy and Paste"><div class="titlepage"><div><div><h3 class="title" id="_copy_and_paste">Copy and Paste</h3></div></div></div><p>You can also copy portions of an Excel spreadsheet and paste them into R. To do this, open the spreadsheet and select the cells you wish to read into R. Then select Edit &gt; Copy in the menu bar—or use a keyboard shortcut—to copy the cells to your clipboard.<a id="id545663" class="indexterm"/><a id="id545627" class="indexterm"/><a id="id545633" class="indexterm"/></p><p>On most operating systems, you can read the data stored in your clipboard into R with:</p><pre class="programlisting">read.table<code class="p">(</code><code class="s">"clipboard"</code><code class="p">)</code></pre><p>On Macs you will need to use:</p><pre class="programlisting">read.table<code class="p">(</code>pipe<code class="p">(</code><code class="s">"pbpaste"</code><code class="p">))</code></pre><p>If the cells contain values with spaces in them, this will disrupt <code class="literal">read.table</code>. You can try another <code class="literal">read</code> function (or just formally export the data from Excel) before reading it into R.</p></div><div class="sect2" title="XLConnect"><div class="titlepage"><div><div><h3 class="title" id="_xlconnect">XLConnect</h3></div></div></div><p>Many packages have been written to help you read Excel files directly into R. Unfortunately, many of these packages do not work on all operating systems. Others have been made out of date by the <span class="emphasis"><em>.xlsx</em></span> file format. One package that does work on all file systems (and gets good reviews) is the XLConnect package.<a id="id545754" class="indexterm"/><a id="id545757" class="indexterm"/><a id="id545762" class="indexterm"/> To use it, you’ll need to install and load the package:</p><pre class="programlisting">install.packages<code class="p">(</code><code class="s">"XLConnect"</code><code class="p">)</code>
library<code class="p">(</code>XLConnect<code class="p">)</code></pre><p>XLConnect relies on Java to be platform independent. So when you first open XLConnect, RStudio may ask to download a Java Runtime Environment if you do not already have one.</p></div><div class="sect2" title="Reading Spreadsheets"><div class="titlepage"><div><div><h3 class="title" id="_reading_spreadsheets">Reading Spreadsheets</h3></div></div></div><p>You can use XLConnect to read in an Excel spreadsheet with either a one- or a two-step process.<a id="id545831" class="indexterm"/><a id="id545835" class="indexterm"/> I’ll start with the two-step process. First, load an Excel workbook with <code class="literal">loadWorkbook</code>. <code class="literal">loadWorkbook</code> can load both <span class="emphasis"><em>.xls</em></span> and <span class="emphasis"><em>.xlsx</em></span> files. It takes one argument: the file path to your Excel workbook (this will be the name of the workbook if it is saved in your working directory):</p><pre class="programlisting">wb <code class="o">&lt;-</code> loadWorkbook<code class="p">(</code><code class="s">"file.xlsx"</code><code class="p">)</code></pre><p>Next, read a spreadsheet from the workbook with <code class="literal">readWorksheet</code>, which takes several arguments.<a id="id545901" class="indexterm"/><a id="id545910" class="indexterm"/> The first argument should be a workbook object created with <code class="literal">loadWorkbook</code>. The next argument, <code class="literal">sheet</code>, should be the name of the spreadsheet in the workbook that you would like to read into R. This will be the name that appears on the bottom tab of the spreadsheet. You can also give <code class="literal">sheet</code> a number, which specifies the sheet that you want to read in (one for the first sheet, two for the second, and so on).</p><p><code class="literal">readWorksheet</code> then takes four arguments that specify a bounding box of cells to read in: <code class="literal">startRow</code>, <code class="literal">startCol</code>, <code class="literal">endRow</code>, and <code class="literal">endCol</code>. Use <code class="literal">startRow</code> and <code class="literal">startCol</code> to describe the cell in the top-left corner of the bounding box of cells that you wish to read in. Use <code class="literal">endRow</code> and <code class="literal">endCol</code> to specify the cell in the bottom-right corner of the bounding box. Each of these arguments takes a number. If you do not supply bounding arguments, <code class="literal">readWorksheet</code> will read in the rectangular region of cells in the spreadsheet that appears to contain data. <code class="literal">readWorksheet</code> will assume that this region contains a header row, but you can tell it otherwise with <code class="literal">header = FALSE</code>.<a id="id545971" class="indexterm"/><a id="id545980" class="indexterm"/><a id="id545999" class="indexterm"/><a id="id546004" class="indexterm"/><a id="id546009" class="indexterm"/></p><p>So to read in the first worksheet from <code class="literal">wb</code>, you could use:</p><pre class="programlisting">sheet1 <code class="o">&lt;-</code> readWorksheet<code class="p">(</code>wb<code class="p">,</code> sheet <code class="o">=</code> <code class="m">1</code><code class="p">,</code> startRow <code class="o">=</code> <code class="m">0</code><code class="p">,</code> startCol <code class="o">=</code> <code class="m">0</code><code class="p">,</code>
  endRow <code class="o">=</code> <code class="m">100</code><code class="p">,</code> endCol <code class="o">=</code> <code class="m">3</code><code class="p">)</code></pre><p>R will save the output as a data frame. All of the arguments in <code class="literal">readWorkbook</code> except the first are vectorized, so you can use it to read in multiple sheets from the same workbook at once (or multiple cell regions from a single worksheet). In this case, <code class="literal">readWorksheet</code> will return a list of data frames.</p><p>You can combine these two steps with <code class="literal">readWorksheetFromFile</code>. It takes the file argument from <code class="literal">loadWorkbook</code> and combines it with the arguments from <code class="literal">readWorksheet</code>. You can use it to read one or more sheets straight from an Excel file:</p><pre class="programlisting">sheet1 <code class="o">&lt;-</code> readWorksheetFromFile<code class="p">(</code><code class="s">"file.xlsx"</code><code class="p">,</code> sheet <code class="o">=</code> <code class="m">1</code><code class="p">,</code> startRow <code class="o">=</code> <code class="m">0</code><code class="p">,</code>
  startCol <code class="o">=</code> <code class="m">0</code><code class="p">,</code> endRow <code class="o">=</code> <code class="m">100</code><code class="p">,</code> endCol <code class="o">=</code> <code class="m">3</code><code class="p">)</code></pre></div><div class="sect2" title="Writing Spreadsheets"><div class="titlepage"><div><div><h3 class="title" id="_writing_spreadsheets">Writing Spreadsheets</h3></div></div></div><p>Writing to an Excel spreadsheet is a four-step process.<a id="id546287" class="indexterm"/><a id="id546289" class="indexterm"/> First, you need to set up a workbook object with <code class="literal">loadWorkbook</code>. This works just as before, except if you are not using an existing Excel file, you should add the argument <code class="literal">create = TRUE</code>. XLConnect will create a blank workbook. When you save it, XLConnect will write it to the file location that you specified here with <code class="literal">loadWorkbook</code>:</p><pre class="programlisting">wb <code class="o">&lt;-</code> loadWorkbook<code class="p">(</code><code class="s">"file.xlsx"</code><code class="p">,</code> create <code class="o">=</code> <code class="kc">TRUE</code><code class="p">)</code></pre><p>Next, you need to create a worksheet inside your workbook object with <code class="literal">createSheet</code>. Tell <code class="literal">createSheet</code> which workbook to place the sheet in and which to use for the sheet.</p><pre class="programlisting">createSheet<code class="p">(</code>wb<code class="p">,</code> <code class="s">"Sheet 1"</code><code class="p">)</code></pre><p>Then you can save your data frame or matrix to the sheet with <code class="literal">writeWorksheet</code>.<a id="id546398" class="indexterm"/> The first argument of <code class="literal">writeWorksheet</code>, <code class="literal">object</code>, is the workbook to write the data to. The second argument, <code class="literal">data</code>, is the data to write. The third argument, <code class="literal">sheet</code>, is the name of the sheet to write it to. The next two arguments, <code class="literal">startRow</code> and <code class="literal">startCol</code>, tell R where in the spreadsheet to place the upper-left cell of the new data. These arguments each default to 1. Finally, you can use <code class="literal">header</code> to tell R whether your column names should be written with the data:</p><pre class="programlisting">writeWorksheet<code class="p">(</code>wb<code class="p">,</code> data <code class="o">=</code> poker<code class="p">,</code> sheet <code class="o">=</code> <code class="s">"Sheet 1"</code><code class="p">)</code></pre><p>Once you have finished adding sheets and data to your workbook, you can save it by running <code class="literal">saveWorkbook</code> on the workbook object. R will save the workbook to the file name or path you provided in <code class="literal">loadWorkbook</code>. If this leads to an existing Excel file, R will overwrite it. If it leads to a new file, R will create it.<a id="id546505" class="indexterm"/><a id="id546491" class="indexterm"/><a id="id546484" class="indexterm"/><a id="id546514" class="indexterm"/><a id="id546521" class="indexterm"/></p><p>You can also collapse these steps into a single call with <code class="literal">writeWorksheetToFile</code>, like this:</p><pre class="programlisting">writeWorksheetToFile<code class="p">(</code><code class="s">"file.xlsx"</code><code class="p">,</code> data <code class="o">=</code> poker<code class="p">,</code> sheet <code class="o">=</code> <code class="s">"Sheet 1"</code><code class="p">,</code>
  startRow <code class="o">=</code> <code class="m">1</code><code class="p">,</code> startCol <code class="o">=</code> <code class="m">1</code><code class="p">)</code></pre><p>The XLConnect package also lets you do more advanced things with Excel spreadsheets, such as writing to a named region in a spreadsheet, working with formulas, and assigning styles to cells.<a id="id546536" class="indexterm"/> You can read about these features in XLConnect’s vignette, which is accessible by loading XLConnect and then running:</p><pre class="programlisting">vignette<code class="p">(</code><code class="s">"XLConnect"</code><code class="p">)</code></pre></div></div><div class="sect1" title="Loading Files from Other Programs"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="_loading_files_from_other_programs">Loading Files from Other Programs</h2></div></div></div><p>You should follow the same advice I gave you for Excel files whenever you wish to work with file formats native to other programs: open the file in the original program and export the data as a plain-text file, usually a CSV. This will ensure the most faithful transcription of the data in the file, and it will usually give you the most options for customizing how the data is transcribed.<a id="id546675" class="indexterm"/><a id="id546680" class="indexterm"/></p><p>Sometimes, however, you may acquire a file but not the program it came from. As a result, you won’t be able to open the file in its native program and export it as a text file. In this case, you can use one of the functions in <a class="xref" href="apd.html#OTHER_FORMATS" title="Table D-4. A number of functions will attempt to read the file types of other data-analysis programs">Table D-4</a> to open the file. These functions mostly come in R’s <code class="literal">foreign</code> package. Each attempts to read in a different file format with as few hiccups as possible.<a id="id546730" class="indexterm"/><a id="id546693" class="indexterm"/><a id="id546713" class="indexterm"/><a id="id546720" class="indexterm"/><a id="id546736" class="indexterm"/><a id="id546742" class="indexterm"/><a id="id546748" class="indexterm"/><a id="id546754" class="indexterm"/></p><div class="table"><a id="OTHER_FORMATS"/><div class="table-title">Table D-4. A number of functions will attempt to read the file types of other data-analysis programs</div><div class="table-contents"><table style="width: 90%; border-collapse: collapse; border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/></colgroup><thead><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">File format</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">Function</td><td style="border-bottom: 0.5pt solid ; ">Library</td></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>ERSI ArcGIS</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">read.shapefile</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>shapefiles</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Matlab</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">readMat</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>R.matlab</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>minitab</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">read.mtp</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>foreign</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>SAS (permanent data set)</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">read.ssd</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>foreign</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>SAS (XPORT format)</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">read.xport</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>foreign</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>SPSS</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">read.spss</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>foreign</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Stata</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">read.dta</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>foreign</p></td></tr><tr><td style="border-right: 0.5pt solid ; "><p>Systat</p></td><td style="border-right: 0.5pt solid ; "><p><code class="literal">read.systat</code></p></td><td><p>foreign</p></td></tr></tbody></table></div></div><div class="sect2" title="Connecting to Databases"><div class="titlepage"><div><div><h3 class="title" id="_connecting_to_databases">Connecting to Databases</h3></div></div></div><p>You can also use R to connect to a database and read in data.<a id="id546990" class="indexterm"/><a id="id547004" class="indexterm"/><a id="id547010" class="indexterm"/><a id="id547018" class="indexterm"/><a id="id547026" class="indexterm"/><a id="id547032" class="indexterm"/> How you do this will depend on the database management system that you use. Working with a database will require experience that goes beyond the skill set of a typical R user. However, if you are interested in doing this, the best place to start is by downloading these R packages and reading their documentation.<a id="id547040" class="indexterm"/><a id="id547046" class="indexterm"/><a id="id547060" class="indexterm"/><a id="id547055" class="indexterm"/><a id="id547065" class="indexterm"/><a id="id547071" class="indexterm"/><a id="id547077" class="indexterm"/><a id="id547083" class="indexterm"/><a id="id547093" class="indexterm"/><a id="id547099" class="indexterm"/><a id="id547105" class="indexterm"/><a id="id547111" class="indexterm"/></p><p>Use the RODBC package to connect to databases through an ODBC connection.</p><p>Use the DBI package to connect to databases through individual drivers. The DBI package provides a common syntax for working with different databases. You will have to download a database-specific package to use in conjunction with DBI. These packages provide the API for the native drivers of different database programs. For MySQL use RMySQL, for SQLite use RSQLite, for Oracle use ROracle, for PostgreSQL use RPostgreSQL, and for databases that use drivers based on the Java Database Connectivity (JDBC) API use RJDBC. Once you have loaded the appropriate driver package, you can use the commands provided by DBI to access your database.</p></div></div></section></body></html>
